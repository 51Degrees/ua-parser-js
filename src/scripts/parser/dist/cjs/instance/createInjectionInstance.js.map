{"version":3,"file":"createInjectionInstance.js","names":["createInjectionInstance","key","script","document","createElement","type","async","src","head","appendChild","Promise","resolve","reject","onload","fod","complete","data","mappedToLegacy","extendWithLegacyProps","proxy","Proxy","RESULT_PROXY_HANDLING","onerror","Error"],"sources":["../../../src/instance/createInjectionInstance.ts"],"sourcesContent":["import RESULT_PROXY_HANDLING from \"../proxies/resultProxy\";\nimport { TApiResponseData } from \"../api/api\";\nimport extendWithLegacyProps from \"../utils/extendWithLegacyProps\";\n\nconst createInjectionInstance = async (\n  key: string,\n): Promise<TApiResponseData> => {\n  try {\n    const script = document.createElement(\"script\");\n    script.type = \"text/javascript\";\n    script.async = true;\n    script.src = `https://cloud.51degrees.com/api/v4/${key}.js`;\n    document.head.appendChild(script);\n    return new Promise<TApiResponseData>((resolve, reject) => {\n      script.onload = () => {\n        // @ts-ignore\n        fod.complete((data) => {\n          const mappedToLegacy = extendWithLegacyProps(data);\n          const proxy = new Proxy(mappedToLegacy, RESULT_PROXY_HANDLING);\n          resolve(proxy);\n        });\n      };\n      script.onerror = () => {\n        reject(\n          \"UAParser-51D device detection failed to load javascript resource\",\n        );\n      };\n    });\n  } catch (error) {\n    throw new Error(`Injection request failed: ${error}`);\n  }\n};\n\nexport default createInjectionInstance;\n"],"mappings":";;;;;;;AAAA;AAEA;AAAmE;AAAA,+CADnE;AAAA;AAAA;AAGA,IAAMA,uBAAuB;EAAA,sEAAG,iBAC9BC,GAAW;IAAA;IAAA;MAAA;QAAA;UAAA;UAGHC,MAAM,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;UAC/CF,MAAM,CAACG,IAAI,GAAG,iBAAiB;UAC/BH,MAAM,CAACI,KAAK,GAAG,IAAI;UACnBJ,MAAM,CAACK,GAAG,gDAAyCN,GAAG,QAAK;UAC3DE,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACP,MAAM,CAAC;UAAC,iCAC3B,IAAIQ,OAAO,CAAmB,UAACC,OAAO,EAAEC,MAAM,EAAK;YACxDV,MAAM,CAACW,MAAM,GAAG,YAAM;cACpB;cACAC,GAAG,CAACC,QAAQ,CAAC,UAACC,IAAI,EAAK;gBACrB,IAAMC,cAAc,GAAG,IAAAC,iCAAqB,EAACF,IAAI,CAAC;gBAClD,IAAMG,KAAK,GAAG,IAAIC,KAAK,CAACH,cAAc,EAAEI,uBAAqB,CAAC;gBAC9DV,OAAO,CAACQ,KAAK,CAAC;cAChB,CAAC,CAAC;YACJ,CAAC;YACDjB,MAAM,CAACoB,OAAO,GAAG,YAAM;cACrBV,MAAM,CACJ,kEAAkE,CACnE;YACH,CAAC;UACH,CAAC,CAAC;QAAA;UAAA;UAAA;UAAA,MAEI,IAAIW,KAAK,kDAAsC;QAAA;QAAA;UAAA;MAAA;IAAA;EAAA,CAExD;EAAA,gBA3BKvB,uBAAuB;IAAA;EAAA;AAAA,GA2B5B;AAAC,eAEaA,uBAAuB;AAAA"}
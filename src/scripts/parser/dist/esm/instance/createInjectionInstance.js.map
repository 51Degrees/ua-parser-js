{"version":3,"file":"createInjectionInstance.js","names":["RESULT_PROXY_HANDLING","extendWithLegacyProps","createInjectionInstance","key","script","document","createElement","type","async","src","head","appendChild","Promise","resolve","reject","onload","fod","complete","data","mappedToLegacy","proxy","Proxy","onerror","error","Error"],"sources":["../../../src/instance/createInjectionInstance.ts"],"sourcesContent":["import RESULT_PROXY_HANDLING from \"../proxies/resultProxy\";\nimport { TApiResponseData } from \"../api/api\";\nimport extendWithLegacyProps from \"../utils/extendWithLegacyProps\";\nimport { USER_KEY_NOT_VALID } from \"../config\";\n\nconst createInjectionInstance = async (\n  key: string\n): Promise<TApiResponseData> => {\n  try {\n    const script = document.createElement(\"script\");\n    script.type = \"text/javascript\";\n    script.async = true;\n    script.src = `https://cloud.51degrees.com/api/v4/${key}.js?cloud.client.product=ua-parser`;\n    document.head.appendChild(script);\n    return new Promise<TApiResponseData>((resolve, reject) => {\n      script.onload = () => {\n        // @ts-ignore\n        fod.complete((data) => {\n          const mappedToLegacy = extendWithLegacyProps(data);\n          const proxy = new Proxy(mappedToLegacy, RESULT_PROXY_HANDLING);\n          resolve(proxy);\n        });\n      };\n      script.onerror = () => {\n        reject(\n          \"UAParser-51D device detection failed to load javascript resource\"\n        );\n      };\n    });\n  } catch (error) {\n    throw new Error(`Injection request failed: ${error}`);\n  }\n};\n\nexport default createInjectionInstance;\n"],"mappings":"AAAA,OAAOA,qBAAqB,MAAM,wBAAwB;AAE1D,OAAOC,qBAAqB,MAAM,gCAAgC;AAGlE,MAAMC,uBAAuB,GAAG,MAC9BC,GAAW,IACmB;EAC9B,IAAI;IACF,MAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;IAC/CF,MAAM,CAACG,IAAI,GAAG,iBAAiB;IAC/BH,MAAM,CAACI,KAAK,GAAG,IAAI;IACnBJ,MAAM,CAACK,GAAG,GAAI,sCAAqCN,GAAI,oCAAmC;IAC1FE,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACP,MAAM,CAAC;IACjC,OAAO,IAAIQ,OAAO,CAAmB,CAACC,OAAO,EAAEC,MAAM,KAAK;MACxDV,MAAM,CAACW,MAAM,GAAG,MAAM;QACpB;QACAC,GAAG,CAACC,QAAQ,CAAEC,IAAI,IAAK;UACrB,MAAMC,cAAc,GAAGlB,qBAAqB,CAACiB,IAAI,CAAC;UAClD,MAAME,KAAK,GAAG,IAAIC,KAAK,CAACF,cAAc,EAAEnB,qBAAqB,CAAC;UAC9Da,OAAO,CAACO,KAAK,CAAC;QAChB,CAAC,CAAC;MACJ,CAAC;MACDhB,MAAM,CAACkB,OAAO,GAAG,MAAM;QACrBR,MAAM,CACJ,kEAAkE,CACnE;MACH,CAAC;IACH,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOS,KAAK,EAAE;IACd,MAAM,IAAIC,KAAK,CAAE,6BAA4BD,KAAM,EAAC,CAAC;EACvD;AACF,CAAC;AAED,eAAerB,uBAAuB"}